var A=Object.defineProperty;var D=(e,t,o)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var T=(e,t,o)=>D(e,typeof t!="symbol"?t+"":t,o);import{r as p,j as s,R as G,a as P,L as O}from"./app-BDybw2Zf.js";import{A as L}from"./app-layout-DmxS3R7f.js";import{b,B as u}from"./button-CSB6wpAd.js";import{g as x,a as f,u as g,s as v,c as y,P as V,T as E,m as U,b as R,d as k,e as M,f as d,h as m}from"./TableCell-CyCKjvho.js";import{u as I}from"./useTranslation-BA_zAzng.js";import"./index-CfJNm8vq.js";import"./index-DMMnmZHR.js";import"./shin-line-logo-DeoKgELm.js";function F(e){return x("MuiCard",e)}f("MuiCard",["root"]);const K=e=>{const{classes:t}=e;return y({root:["root"]},F,t)},W=v(V,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})({overflow:"hidden"}),Z=p.forwardRef(function(t,o){const r=g({props:t,name:"MuiCard"}),{className:n,raised:a=!1,...l}=r,i={...r,raised:a},c=K(i);return s.jsx(W,{className:b(c.root,n),elevation:a?8:void 0,ref:o,ownerState:i,...l})});function q(e){return x("MuiCardContent",e)}f("MuiCardContent",["root"]);const J=e=>{const{classes:t}=e;return y({root:["root"]},q,t)},Q=v("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:16,"&:last-child":{paddingBottom:24}}),X=p.forwardRef(function(t,o){const r=g({props:t,name:"MuiCardContent"}),{className:n,component:a="div",...l}=r,i={...r,component:a},c=J(i);return s.jsx(Q,{as:a,className:b(c.root,n),ownerState:i,ref:o,...l})});function Y(e){return x("MuiTable",e)}f("MuiTable",["root","stickyHeader"]);const ee=e=>{const{classes:t,stickyHeader:o}=e;return y({root:["root",o&&"stickyHeader"]},Y,t)},te=v("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,o.stickyHeader&&t.stickyHeader]}})(U(({theme:e})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...e.typography.body2,padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:t})=>t.stickyHeader,style:{borderCollapse:"separate"}}]}))),N="table",se=p.forwardRef(function(t,o){const r=g({props:t,name:"MuiTable"}),{className:n,component:a=N,padding:l="normal",size:i="medium",stickyHeader:c=!1,...h}=r,C={...r,component:a,padding:l,size:i,stickyHeader:c},w=ee(C),z=p.useMemo(()=>({padding:l,size:i,stickyHeader:c}),[l,i,c]);return s.jsx(E.Provider,{value:z,children:s.jsx(te,{as:a,role:a===N?null:"table",ref:o,className:b(w.root,n),ownerState:C,...h})})});function ae(e){return x("MuiTableBody",e)}f("MuiTableBody",["root"]);const oe=e=>{const{classes:t}=e;return y({root:["root"]},ae,t)},re=v("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-row-group"}),ne={variant:"body"},S="tbody",le=p.forwardRef(function(t,o){const r=g({props:t,name:"MuiTableBody"}),{className:n,component:a=S,...l}=r,i={...r,component:a},c=oe(i);return s.jsx(R.Provider,{value:ne,children:s.jsx(re,{className:b(c.root,n),as:a,ref:o,role:a===S?null:"rowgroup",ownerState:i,...l})})});function ie(e){return x("MuiTableHead",e)}f("MuiTableHead",["root"]);const ce=e=>{const{classes:t}=e;return y({root:["root"]},ie,t)},de=v("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-header-group"}),pe={variant:"head"},$="thead",ue=p.forwardRef(function(t,o){const r=g({props:t,name:"MuiTableHead"}),{className:n,component:a=$,...l}=r,i={...r,component:a},c=ce(i);return s.jsx(R.Provider,{value:pe,children:s.jsx(de,{as:a,className:b(c.root,n),ref:o,role:a===$?null:"rowgroup",ownerState:i,...l})})});function me(e){return x("MuiTableRow",e)}const B=f("MuiTableRow",["root","selected","hover","head","footer"]),he=e=>{const{classes:t,selected:o,hover:r,head:n,footer:a}=e;return y({root:["root",o&&"selected",r&&"hover",n&&"head",a&&"footer"]},me,t)},be=v("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,o.head&&t.head,o.footer&&t.footer]}})(U(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${B.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${B.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:k(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:k(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)}}}))),H="tr",_=p.forwardRef(function(t,o){const r=g({props:t,name:"MuiTableRow"}),{className:n,component:a=H,hover:l=!1,selected:i=!1,...c}=r,h=p.useContext(R),C={...r,component:a,hover:l,selected:i,head:h&&h.variant==="head",footer:h&&h.variant==="footer"},w=he(C);return s.jsx(be,{as:a,ref:o,className:b(w.root,n),role:a===H?null:"row",ownerState:C,...c})}),xe=M(s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20"})),fe=M(s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),ge=M(s.jsx("path",{d:"M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m13.5-9 1.96 2.5H17V9.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"})),j=e=>{if(!e)return"—";const t=new Date(e);return new Intl.DateTimeFormat("kk-KZ",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)},ve=({task:e})=>s.jsx(Z,{sx:{maxWidth:600,margin:"10px",boxShadow:3,borderRadius:2},children:s.jsxs(X,{children:[s.jsxs(d,{variant:"h6",gutterBottom:!0,color:"primary",children:["📌 ",e.id," | 🚚 Рейс: ",e.name," | ",e.status_name]}),s.jsxs(d,{variant:"subtitle2",color:"textSecondary",children:["📅 План: ",j(e.plan_date)," | ⏳ Прибытие: ",j(e.begin_date)," | 🚀 Убытие: ",j(e.end_date)]}),s.jsx(d,{variant:"body2",sx:{mt:1},children:e.description}),s.jsxs(d,{variant:"body2",sx:{mt:1},children:["🏠 ",e.yard_name]}),s.jsxs(d,{variant:"body2",color:"secondary",children:["📞 Координатор: ",e.avtor," ",e.phone&&` | Тел: ${e.phone}`]}),s.jsxs(d,{variant:"body2",children:[s.jsx(ge,{color:"action"})," Компания: ",e.company||"Не указано"," | Номер ТС: ",s.jsx("b",{children:e.truck_plate_number}),e.trailer_plate_number&&` | Номер прицепа: ${e.trailer_plate_number}`,e.truck_model&&` | Модель: ${e.truck_model}`,e.truck_category_name&&` | Категория: ${e.truck_category_name}`,e.trailer_type_name&&` | Тип прицепа: ${e.trailer_type_name}`,e.color&&` | Цвет: ${e.color}`]}),s.jsxs(d,{variant:"body2",children:[s.jsx(xe,{color:"primary"})," Водитель: ",e.user_name," | Login: ",e.user_login," | Тел: ",e.user_phone]}),s.jsxs(se,{size:"small",sx:{mt:2},children:[s.jsx(ue,{children:s.jsx(_,{children:s.jsx(m,{align:"center",colSpan:3,children:s.jsx(d,{variant:"subtitle2",children:s.jsx("b",{children:"Задачи"})})})})}),s.jsxs(le,{children:[e.task_weighings.map((t,o)=>s.jsxs(_,{sx:{backgroundColor:"#e0f2f1"},children:[s.jsxs(m,{children:[s.jsx(fe,{color:"success"})," ",t.statuse_weighing_name]}),s.jsxs(m,{children:["Вес: ",s.jsx("b",{children:t.weight})]}),s.jsx(m,{children:t.weight?j(t.updated_at):"—"})]},o)),e.task_loadings.map((t,o)=>s.jsxs(_,{sx:{backgroundColor:"#fff3e0"},children:[s.jsx(m,{children:t.warehouse_name}),s.jsxs(m,{children:["План: ",s.jsx("b",{children:t.warehouse_gate_plan_name})]}),s.jsxs(m,{children:["Факт: ",s.jsx("b",{children:t.warehouse_gate_fact_name})]})]},o))]})]})]})});class ye extends G.Component{constructor(o){super(o);T(this,"Gettasks",o=>{P.post("/task/gettasks",{page:o}).then(r=>{this.state.view_app.length=0,this.state.paginate.length=0;const n=[];if(r.data.current_page>0){const a=Number(r.data.current_page),l=Number(r.data.last_page);this.state.paginate.length===0&&(n.push(s.jsx(u,{className:"paginateButton ms-1",size:"sm",onClick:()=>this.Gettasks(1),children:"«"},a*20)),a-2>0&&n.push(s.jsx(u,{className:"paginateButton ms-1",size:"sm",onClick:()=>this.Gettasks(a-2),children:a-2},a-2)),a-1>0&&n.push(s.jsx(u,{className:"paginateButton ms-1",size:"sm",onClick:()=>this.Gettasks(a-1),children:a-1},a-1)),n.push(s.jsx(u,{disabled:!0,size:"sm",className:"paginateButton ms-1",children:a},a)),a+1<=l&&n.push(s.jsx(u,{className:"paginateButton ms-1",size:"sm",onClick:()=>this.Gettasks(a+1),children:a+1},a+1)),a+2<=l&&n.push(s.jsx(u,{className:"paginateButton ms-1",size:"sm",onClick:()=>this.Gettasks(a+2),children:a+2},a+2)),n.push(s.jsx(u,{className:"paginateButton ms-1",size:"sm",onClick:()=>this.Gettasks(l),children:"»"},a*10)))}this.setState({paginate:n}),this.setState({tasks:r.data.data,main_cont:!1},()=>{this.view_app()})}).catch(r=>{console.error("Ошибка при получении задания:",r)})});T(this,"view_app",()=>{if(this.state.tasks.length>0){const o=this.state.tasks.map((r,n)=>s.jsx(ve,{task:r}));this.setState({view_app:o})}});this.state={tasks:[],paginate:[],view_app:[],main_cont:!0,selectedTask:null,showModal:!1,isEditMode:!1,newTaskName:"",newTaskDescription:"",newTaskStatus:"",newTaskPriority:"",newTaskAssignee:"",newTaskDueDate:""}}componentDidMount(){this.Gettasks(1)}render(){return s.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[s.jsx("div",{className:"grid auto-rows-min gap-4 md:grid-cols-3",children:this.state.view_app.map((o,r)=>o)}),s.jsxs("div",{className:"sticky bottom-0 w-full flex justify-center p-4 rounded-xl shadow-md",children:[" ",this.state.paginate.map((o,r)=>o)]},"pagination")]})}}function Se(){const{t:e}=I(),t=[{title:e("tasks"),href:"/tasks"}];return s.jsxs(L,{breadcrumbs:t,children:[s.jsx(O,{title:e("tasks")}),s.jsx(ye,{})]})}export{Se as default};
