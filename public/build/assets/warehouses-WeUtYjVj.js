import{r as t,a as x,j as e,L as g}from"./app-C2sKqGuk.js";import{S as j}from"./warehouse-layout-Da9tyc2q.js";import{A as W}from"./app-layout-B9z0nEEC.js";import{B as h,u as b}from"./index-DtBTvuy0.js";import{F as S,I as w,S as y,M as v,T as N,B as C,C as L,D as I}from"./DataGrid-Bu30X-AQ.js";import"./heading-CQrY44G1.js";import"./index-Cy5X9-6g.js";import"./button-CiXunvm5.js";import"./index-DY5GBYP5.js";import"./shin-line-logo-DeoKgELm.js";import"./useTranslation-sWXn4umK.js";import"./index-DbH_zRjn.js";import"./common-IVtOcpAX.js";const E=({onWarehouseAdded:n})=>{const[u,o]=t.useState([]),[r,d]=t.useState(""),[i,c]=t.useState(""),[m,s]=t.useState(!0),[f,l]=t.useState("");t.useEffect(()=>{x.post("/yard/getyards").then(a=>{a.data.status?o(a.data.data):l(a.data.message)}).catch(()=>l("Ошибка загрузки дворов")).finally(()=>s(!1))},[]);const p=()=>{if(!r||!i.trim()){l("Заполните все поля!");return}x.post("/warehouse/addwarehouse",{name:i,yard_id:r}).then(a=>{a.data.status?(c(""),d(""),n(a.data.data)):l(a.data.message)}).catch(()=>l("Ошибка добавления склада"))};return e.jsxs(h,{sx:{maxWidth:400,margin:"auto",padding:3},children:[e.jsx("h2",{children:"Добавить новый склад"}),f&&e.jsx("p",{style:{color:"red"},children:f}),e.jsxs(S,{fullWidth:!0,sx:{mb:2},children:[e.jsx(w,{children:"Выберите двор"}),e.jsx(y,{value:r,onChange:a=>d(a.target.value),disabled:m,children:u.map(a=>e.jsx(v,{value:a.id,children:a.name},a.id))})]}),e.jsx(N,{label:"Название склада",fullWidth:!0,value:i,onChange:a=>c(a.target.value),sx:{mb:2}}),e.jsx(C,{variant:"contained",color:"primary",fullWidth:!0,onClick:p,children:"Добавить склад"})]})},A=()=>{const[n,u]=t.useState([]),[o,r]=t.useState(!0),d=b("(max-width: 768px)"),i=()=>{r(!0),x.post("/warehouse/getwarehouses").then(s=>{s.data.status&&u(s.data.data)}).catch(s=>console.error("Ошибка загрузки складов:",s)).finally(()=>r(!1))};t.useEffect(()=>{i()},[]);const c=()=>{i()},m=[{field:"id",headerName:"ID",width:d?50:80},{field:"name",headerName:"Название",flex:1,minWidth:150},{field:"barcode",headerName:"Штрихкод",flex:1,minWidth:100},{field:"address",headerName:"Адрес",flex:1,minWidth:200},{field:"phone",headerName:"Телефон",flex:1,minWidth:150},{field:"yard_name",headerName:"Зона",flex:2,minWidth:250}];return e.jsxs(h,{children:[e.jsx(E,{onWarehouseAdded:c}),e.jsxs(h,{sx:{width:"100%",maxWidth:"1200px",margin:"auto",padding:"10px"},children:[e.jsx("h2",{style:{textAlign:"center"},children:"Склады"}),o?e.jsx(h,{sx:{display:"flex",justifyContent:"center",padding:5},children:e.jsx(L,{})}):e.jsx(h,{sx:{height:500,width:"100%"},children:e.jsx(I,{rows:n,columns:m,loading:o,getRowId:s=>s.id,pageSizeOptions:d?[5]:[5,10,20]})})]})]})},B=[{title:"Склады",href:"/warehouses"}];function q(){const[n,u]=t.useState([]),[o,r]=t.useState(!0),[d,i]=t.useState([]);return t.useEffect(()=>{},[d]),e.jsxs(W,{breadcrumbs:B,children:[e.jsx(g,{title:"Склады"}),e.jsx(j,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min p-4",children:e.jsx(A,{warehouses:n,loading:o})})})})]})}export{q as default};
