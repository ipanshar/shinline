import{r,j as e,a as f,L as _}from"./app-CqFx5Rqn.js";import{A as w}from"./app-layout-D5CBteLY.js";import"./button-CulBlrr3.js";import"./index-D9wv9xhR.js";import"./index-PxyD74vO.js";import"./shin-line-logo-DeoKgELm.js";import"./useTranslation-Y75jHl6b.js";const C=()=>{const[t,u]=r.useState(null),[a,h]=r.useState({base_url:"",user_name:"",password:""}),[i,c]=r.useState(!1),[m,b]=r.useState(!0),[p,g]=r.useState(!1),[j,d]=r.useState("");r.useEffect(()=>{(async()=>{try{const o=(await f.post("/dss/settings")).data;u(o),h({base_url:o.base_url,user_name:o.user_name,password:o.password})}catch(l){console.error("Ошибка загрузки настроек:",l),d("Не удалось загрузить настройки.")}finally{b(!1)}})()},[]);const x=n=>{const{name:l,value:o}=n.target;h(S=>({...S,[l]:o}))},y=async()=>{if(t){g(!0),d("");try{await f.post("/dss/settings/update",{id:t.id,...a}),d("Настройки успешно сохранены"),c(!1),u(n=>n&&{...n,...a,updated_at:new Date().toISOString()})}catch(n){console.error("Ошибка при сохранении:",n),d("Ошибка при сохранении настроек")}finally{g(!1)}}};return m?e.jsx("div",{style:s.container,children:"Загрузка настроек..."}):t?e.jsxs("div",{style:s.container,children:[e.jsx("strong",{children:"Настройки подключения к серверу DSS"}),e.jsx("table",{style:s.table,children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Базовый URL"})}),e.jsx("td",{children:i?e.jsx("input",{name:"base_url",value:a.base_url,onChange:x,style:s.input}):t.base_url})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Логин"})}),e.jsx("td",{children:i?e.jsx("input",{name:"user_name",value:a.user_name,onChange:x,style:s.input}):t.user_name})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Пароль"})}),e.jsx("td",{children:i?e.jsx("input",{name:"password",type:"password",value:a.password,onChange:x,style:s.input}):"********"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Тип клиента"})}),e.jsx("td",{children:t.client_type})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Токен"})}),e.jsx("td",{children:t.token||"—"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Сессия началась"})}),e.jsx("td",{children:t.begin_session||"—"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Создано"})}),e.jsx("td",{children:new Date(t.created_at).toLocaleString()})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Обновлено"})}),e.jsx("td",{children:new Date(t.updated_at).toLocaleString()})]})]})}),e.jsx("div",{style:s.buttonRow,children:i?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:y,disabled:p,style:s.button,children:p?"Сохранение...":"Сохранить"}),e.jsx("button",{onClick:()=>c(!1),style:s.cancelButton,children:"Отмена"})]}):e.jsx("button",{onClick:()=>c(!0),style:s.button,children:"Редактировать"})}),j&&e.jsx("div",{style:s.message,children:j})]}):e.jsx("div",{style:s.container,children:"Ошибка загрузки конфигурации."})},s={container:{padding:"20px",fontFamily:"Arial, sans-serif",backgroundColor:"#f5f5f5",borderRadius:"8px",maxWidth:"600px",margin:"auto",marginTop:"40px",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},table:{width:"100%",borderCollapse:"collapse",marginBottom:"20px"},input:{width:"100%",padding:"6px",fontSize:"14px"},buttonRow:{display:"flex",gap:"10px"},button:{padding:"8px 16px",backgroundColor:"#1976d2",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},cancelButton:{padding:"8px 16px",backgroundColor:"#777",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},message:{marginTop:"10px",color:"#007700",fontWeight:"bold"}},v=[{title:"Интеграция DSS",href:"/integration_dss"}];function F(){return e.jsxs(w,{breadcrumbs:v,children:[e.jsx(_,{title:"Интеграция DSS"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsx(C,{})})]})}export{F as default};
