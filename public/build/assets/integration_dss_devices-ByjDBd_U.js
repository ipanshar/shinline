import{r as l,R as v,j as t,L as y,a as x}from"./app-C2sKqGuk.js";import{A as I}from"./app-layout-B9z0nEEC.js";import{S as M}from"./dss-layout-C7SaYUei.js";import{G as c,S as k,C as E,E as D}from"./GridActionsCellItem-D9LsiM9D.js";import{u as A,B as p}from"./index-DtBTvuy0.js";import{C as G,D as L,G as o}from"./DataGrid-Bu30X-AQ.js";import"./button-CiXunvm5.js";import"./index-DY5GBYP5.js";import"./index-Cy5X9-6g.js";import"./shin-line-logo-DeoKgELm.js";import"./useTranslation-sWXn4umK.js";import"./heading-CQrY44G1.js";import"./index-DbH_zRjn.js";import"./common-IVtOcpAX.js";const W=[{title:"Устройства DSS",href:"/integration_dss/devices"}];function O(){const[r,n]=l.useState([]),[f,m]=l.useState(!0),u=A("(max-width: 768px)"),[s,a]=v.useState({}),j=()=>{m(!0),x.post("/dss/dssdevices").then(e=>{e.data.status&&n(e.data.data)}).catch(e=>console.error("Ошибка загрузки устройств:",e)).finally(()=>m(!1))};l.useEffect(()=>{j()},[]);const b=e=>()=>{a({...s,[e]:{mode:o.View}})},C=e=>()=>{a({...s,[e]:{mode:o.Edit}})},S=e=>()=>{a({...s,[e]:{mode:o.View}})},g=e=>{const d={id:e.id,channelId:e.channelId,channelName:e.channelName,checkpoint_id:e.checkpoint_id,type:e.type};return n(r.map(i=>i.id===e.id?d:i)),x.post("/dss/dssdevices/update",d).then(i=>{i.data.status?n(r.map(h=>h.id===e.id?d:h)):console.error("Ошибка обновления устройства:",i.data.message)}).catch(i=>console.error("Ошибка при обновлении устройства:",i))},N=[{field:"id",headerName:"ИД",width:u?50:80},{field:"channelId",headerName:"channelId",flex:1,minWidth:120},{field:"channelName",headerName:"channelName",flex:1,minWidth:120,editable:!0},{field:"checkpoint_id",headerName:"Checkpoint ID",flex:1,minWidth:120,editable:!0},{field:"type",headerName:"Тип",flex:1,minWidth:120,editable:!0},{field:"actions",headerName:"",width:120,headerAlign:"center",type:"actions",cellClassName:"actions",getActions:({id:e})=>{var i;return((i=s[e])==null?void 0:i.mode)===o.Edit?[t.jsx(c,{icon:t.jsx(k,{}),label:"Save",onClick:S(e)}),t.jsx(c,{icon:t.jsx(E,{}),label:"Cancel",className:"textPrimary",onClick:b(e),color:"inherit"})]:[t.jsx(c,{icon:t.jsx(D,{}),label:"Edit",className:"textPrimary",onClick:C(e),color:"inherit"})]}}];return t.jsxs(I,{breadcrumbs:W,children:[t.jsx(y,{title:"Устройства DSS"}),t.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:t.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min p-4",children:t.jsxs(M,{children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Управление устройствами DSS"}),t.jsxs(p,{sx:{width:"100%",maxWidth:"1200px",margin:"auto",padding:"10px"},children:[t.jsx("h2",{style:{textAlign:"center"},children:"Управление устройствами DSS"}),f?t.jsx(p,{sx:{display:"flex",justifyContent:"center",padding:5},children:t.jsx(G,{})}):t.jsx(L,{rows:r,columns:N,rowModesModel:s,onRowModesModelChange:e=>a(e),processRowUpdate:g,editMode:"row",getRowId:e=>e.id})]})]})})})]})}export{O as default};
