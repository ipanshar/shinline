import{r as c,j as e,t as w,a as p,L as y}from"./app--vS__Gf7.js";import{A as S}from"./app-layout-CKY0kun-.js";import{i as v,j as W,k as C,l as E,n as L,a as I,C as M,o as j,p as B}from"./TableCell-DijXRIvB.js";import{b as T}from"./button-5U2Wfnuf.js";import{g as Q,u as _,F,I as R,S as k,M as A,T as D,B as P,C as U,D as Y}from"./DataGrid-DxOzIteW.js";import"./index-BgGCI-KR.js";import"./index-BIzC_kvZ.js";import"./shin-line-logo-DeoKgELm.js";import"./useTranslation-Dq1_ZVf4.js";import"./index-DUqIgLCC.js";function G(r={}){const{themeId:h,defaultTheme:s,defaultClassName:a="MuiBox-root",generateClassName:o}=r,t=v("div",{shouldForwardProp:d=>d!=="theme"&&d!=="sx"&&d!=="as"})(W);return c.forwardRef(function(l,x){const u=C(s),{className:m,component:i="div",...g}=E(l);return e.jsx(t,{as:i,ref:x,className:T(m,o?o(a):a),theme:h&&u[h]||u,...g})})}function O(r,h,s,a,o){const[t,n]=c.useState(()=>o&&s?s(r).matches:a?a(r).matches:h);return _(()=>{if(!s)return;const d=s(r),l=()=>{n(d.matches)};return l(),d.addEventListener("change",l),()=>{d.removeEventListener("change",l)}},[r,s]),t}const z={...w},b=z.useSyncExternalStore;function H(r,h,s,a,o){const t=c.useCallback(()=>h,[h]),n=c.useMemo(()=>{if(o&&s)return()=>s(r).matches;if(a!==null){const{matches:u}=a(r);return()=>u}return t},[t,r,a,o,s]),[d,l]=c.useMemo(()=>{if(s===null)return[t,()=>()=>{}];const u=s(r);return[()=>u.matches,m=>(u.addEventListener("change",m),()=>{u.removeEventListener("change",m)})]},[t,s,r]);return b(l,d,n)}function N(r={}){const{themeId:h}=r;return function(a,o={}){let t=L();t&&h&&(t=t[h]||t);const n=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:d=!1,matchMedia:l=n?window.matchMedia:null,ssrMatchMedia:x=null,noSsr:u=!1}=Q({name:"MuiUseMediaQuery",props:o,theme:t});let m=typeof a=="function"?a(t):a;return m=m.replace(/^@media( ?)/m,""),(b!==void 0?H:O)(m,d,l,x,u)}}N();const $=I("MuiBox",["root"]),J=B(),f=G({themeId:j,defaultTheme:J,defaultClassName:$.root,generateClassName:M.generate}),K=N({themeId:j}),V=({onWarehouseAdded:r})=>{const[h,s]=c.useState([]),[a,o]=c.useState(""),[t,n]=c.useState(""),[d,l]=c.useState(!0),[x,u]=c.useState("");c.useEffect(()=>{p.post("/yard/getyards").then(i=>{i.data.status?s(i.data.data):u(i.data.message)}).catch(()=>u("Ошибка загрузки дворов")).finally(()=>l(!1))},[]);const m=()=>{if(!a||!t.trim()){u("Заполните все поля!");return}p.post("/warehouse/addwarehouse",{name:t,yard_id:a}).then(i=>{i.data.status?(n(""),o(""),r(i.data.data)):u(i.data.message)}).catch(()=>u("Ошибка добавления склада"))};return e.jsxs(f,{sx:{maxWidth:400,margin:"auto",padding:3},children:[e.jsx("h2",{children:"Добавить новый склад"}),x&&e.jsx("p",{style:{color:"red"},children:x}),e.jsxs(F,{fullWidth:!0,sx:{mb:2},children:[e.jsx(R,{children:"Выберите двор"}),e.jsx(k,{value:a,onChange:i=>o(i.target.value),disabled:d,children:h.map(i=>e.jsx(A,{value:i.id,children:i.name},i.id))})]}),e.jsx(D,{label:"Название склада",fullWidth:!0,value:t,onChange:i=>n(i.target.value),sx:{mb:2}}),e.jsx(P,{variant:"contained",color:"primary",fullWidth:!0,onClick:m,children:"Добавить склад"})]})},X=()=>{const[r,h]=c.useState([]),[s,a]=c.useState(!0),o=K("(max-width: 768px)"),t=()=>{a(!0),p.post("/warehouse/getwarehouses").then(l=>{l.data.status&&h(l.data.data)}).catch(l=>console.error("Ошибка загрузки складов:",l)).finally(()=>a(!1))};c.useEffect(()=>{t()},[]);const n=()=>{t()},d=[{field:"id",headerName:"ID",width:o?50:80},{field:"name",headerName:"Название",flex:1,minWidth:150},{field:"address",headerName:"Адрес",flex:1,minWidth:200},{field:"phone",headerName:"Телефон",flex:1,minWidth:150},{field:"yard_name",headerName:"Зона",flex:2,minWidth:250}];return e.jsxs(f,{children:[e.jsx(V,{onWarehouseAdded:n}),e.jsxs(f,{sx:{width:"100%",maxWidth:"1200px",margin:"auto",padding:"10px"},children:[e.jsx("h2",{style:{textAlign:"center"},children:"Склады"}),s?e.jsx(f,{sx:{display:"flex",justifyContent:"center",padding:5},children:e.jsx(U,{})}):e.jsx(f,{sx:{height:500,width:"100%"},children:e.jsx(Y,{rows:r,columns:d,loading:s,getRowId:l=>l.id,pageSizeOptions:o?[5]:[5,10,20]})})]})]})},Z=[{title:"Склады",href:"/warehouses"}];function ie(){const[r,h]=c.useState([]),[s,a]=c.useState(!0),[o,t]=c.useState([]);return c.useEffect(()=>{p.get("/api/task/gate-codes").then(n=>t(n.data.data)).catch(n=>console.error(n)),console.log(o)},[o]),e.jsxs(S,{breadcrumbs:Z,children:[e.jsx(y,{title:"Склады"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsxs("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min p-4",children:[e.jsx(X,{warehouses:r,loading:s}),e.jsxs("table",{className:"min-w-full text-sm border mt-4",children:[e.jsx("thead",{className:"bg-gray-100 font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"Двор"}),e.jsx("th",{className:"p-2 border",children:"Склад"}),e.jsx("th",{className:"p-2 border",children:"Ворота"}),e.jsx("th",{className:"p-2 border",children:"Код"})]})}),e.jsx("tbody",{children:o.map((n,d)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 border",children:n.yard_name}),e.jsx("td",{className:"p-2 border",children:n.warehouse_name}),e.jsx("td",{className:"p-2 border",children:n.gate_name}),e.jsx("td",{className:"p-2 border font-mono",children:n.code})]},d))})]})]})})]})}export{ie as default};
