import{r as t,a as x,j as e,L as j}from"./app-DUyv2vMF.js";import{B as u,u as b,S as g}from"./index-QQM2jwWi.js";import{A as N}from"./app-layout-D3aOKE7C.js";import{F as W,I as w,S as y,M as S,T as v,B as C,C as L,D as I}from"./DataGrid-CWBvRwyq.js";import"./heading-Dfl84INF.js";import"./index-BGR1gm8V.js";import"./button-g_VPEBkA.js";import"./index-BUl_ciKf.js";import"./shin-line-logo-DeoKgELm.js";import"./useTranslation-s2IH1_qR.js";import"./index-BmN9TI0W.js";const E=({onWarehouseAdded:n})=>{const[m,l]=t.useState([]),[i,r]=t.useState(""),[d,s]=t.useState(""),[h,o]=t.useState(!0),[f,c]=t.useState("");t.useEffect(()=>{x.post("/yard/getyards").then(a=>{a.data.status?l(a.data.data):c(a.data.message)}).catch(()=>c("Ошибка загрузки дворов")).finally(()=>o(!1))},[]);const p=()=>{if(!i||!d.trim()){c("Заполните все поля!");return}x.post("/warehouse/addwarehouse",{name:d,yard_id:i}).then(a=>{a.data.status?(s(""),r(""),n(a.data.data)):c(a.data.message)}).catch(()=>c("Ошибка добавления склада"))};return e.jsxs(u,{sx:{maxWidth:400,margin:"auto",padding:3},children:[e.jsx("h2",{children:"Добавить новый склад"}),f&&e.jsx("p",{style:{color:"red"},children:f}),e.jsxs(W,{fullWidth:!0,sx:{mb:2},children:[e.jsx(w,{children:"Выберите двор"}),e.jsx(y,{value:i,onChange:a=>r(a.target.value),disabled:h,children:m.map(a=>e.jsx(S,{value:a.id,children:a.name},a.id))})]}),e.jsx(v,{label:"Название склада",fullWidth:!0,value:d,onChange:a=>s(a.target.value),sx:{mb:2}}),e.jsx(C,{variant:"contained",color:"primary",fullWidth:!0,onClick:p,children:"Добавить склад"})]})},A=()=>{const[n,m]=t.useState([]),[l,i]=t.useState(!0),r=b("(max-width: 768px)"),d=()=>{i(!0),x.post("/warehouse/getwarehouses").then(o=>{o.data.status&&m(o.data.data)}).catch(o=>console.error("Ошибка загрузки складов:",o)).finally(()=>i(!1))};t.useEffect(()=>{d()},[]);const s=()=>{d()},h=[{field:"id",headerName:"ID",width:r?50:80},{field:"name",headerName:"Название",flex:1,minWidth:150},{field:"barcode",headerName:"Штрихкод",flex:1,minWidth:100},{field:"address",headerName:"Адрес",flex:1,minWidth:200},{field:"phone",headerName:"Телефон",flex:1,minWidth:150},{field:"yard_name",headerName:"Зона",flex:2,minWidth:250}];return e.jsxs(u,{children:[e.jsx(E,{onWarehouseAdded:s}),e.jsxs(u,{sx:{width:"100%",maxWidth:"1200px",margin:"auto",padding:"10px"},children:[e.jsx("h2",{style:{textAlign:"center"},children:"Склады"}),l?e.jsx(u,{sx:{display:"flex",justifyContent:"center",padding:5},children:e.jsx(L,{})}):e.jsx(u,{sx:{height:500,width:"100%"},children:e.jsx(I,{rows:n,columns:h,loading:l,getRowId:o=>o.id,pageSizeOptions:r?[5]:[5,10,20]})})]})]})},_=[{title:"Склады",href:"/warehouses"}];function P(){const[n,m]=t.useState([]),[l,i]=t.useState(!0),[r,d]=t.useState([]);return t.useEffect(()=>{x.get("/task/gate-codes").then(s=>d(s.data.data)).catch(s=>console.error(s))},[r]),e.jsxs(N,{breadcrumbs:_,children:[e.jsx(j,{title:"Склады"}),e.jsx(g,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsxs("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min p-4",children:[e.jsx(A,{warehouses:n,loading:l}),e.jsxs("table",{className:"min-w-full text-sm border mt-4",children:[e.jsx("thead",{className:"bg-gray-100 font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"Двор"}),e.jsx("th",{className:"p-2 border",children:"Склад"}),e.jsx("th",{className:"p-2 border",children:"Ворота"}),e.jsx("th",{className:"p-2 border",children:"Код"})]})}),e.jsx("tbody",{children:r.map((s,h)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 border",children:s.yard_name}),e.jsx("td",{className:"p-2 border",children:s.warehouse_name}),e.jsx("td",{className:"p-2 border",children:s.gate_name}),e.jsx("td",{className:"p-2 border font-mono",children:s.code})]},h))})]})]})})})]})}export{P as default};
