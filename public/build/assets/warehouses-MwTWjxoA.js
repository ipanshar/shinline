import{r as l,j as e,t as S,a as p,L as v}from"./app-1A-Yh68B.js";import{A as y}from"./app-layout-BWnoW8JI.js";import{i as W,j as N,k as C,l as E,n as L,a as I,C as M,o as j,p as B}from"./TableCell-D4bjNzFe.js";import{b as T}from"./button-BddtU24M.js";import{g as Q,u as F,F as R,I as A,S as D,M as k,T as P,B as U,C as Y,D as _}from"./DataGrid-BDtn9wOM.js";import"./index-ca5eI-Xb.js";import"./index-Brjpg4pZ.js";import"./shin-line-logo-DeoKgELm.js";import"./index-C784l-6C.js";function G(r={}){const{themeId:u,defaultTheme:t,defaultClassName:a="MuiBox-root",generateClassName:c}=r,s=W("div",{shouldForwardProp:i=>i!=="theme"&&i!=="sx"&&i!=="as"})(N);return l.forwardRef(function(n,f){const d=C(t),{className:m,component:o="div",...g}=E(n);return e.jsx(s,{as:o,ref:f,className:T(m,c?c(a):a),theme:u&&d[u]||d,...g})})}function O(r,u,t,a,c){const[s,h]=l.useState(()=>c&&t?t(r).matches:a?a(r).matches:u);return F(()=>{if(!t)return;const i=t(r),n=()=>{h(i.matches)};return n(),i.addEventListener("change",n),()=>{i.removeEventListener("change",n)}},[r,t]),s}const z={...S},b=z.useSyncExternalStore;function H(r,u,t,a,c){const s=l.useCallback(()=>u,[u]),h=l.useMemo(()=>{if(c&&t)return()=>t(r).matches;if(a!==null){const{matches:d}=a(r);return()=>d}return s},[s,r,a,c,t]),[i,n]=l.useMemo(()=>{if(t===null)return[s,()=>()=>{}];const d=t(r);return[()=>d.matches,m=>(d.addEventListener("change",m),()=>{d.removeEventListener("change",m)})]},[s,t,r]);return b(n,i,h)}function w(r={}){const{themeId:u}=r;return function(a,c={}){let s=L();s&&u&&(s=s[u]||s);const h=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:i=!1,matchMedia:n=h?window.matchMedia:null,ssrMatchMedia:f=null,noSsr:d=!1}=Q({name:"MuiUseMediaQuery",props:c,theme:s});let m=typeof a=="function"?a(s):a;return m=m.replace(/^@media( ?)/m,""),(b!==void 0?H:O)(m,i,n,f,d)}}w();const $=I("MuiBox",["root"]),J=B(),x=G({themeId:j,defaultTheme:J,defaultClassName:$.root,generateClassName:M.generate}),K=w({themeId:j}),V=({onWarehouseAdded:r})=>{const[u,t]=l.useState([]),[a,c]=l.useState(""),[s,h]=l.useState(""),[i,n]=l.useState(!0),[f,d]=l.useState("");l.useEffect(()=>{p.post("/yard/getyards").then(o=>{o.data.status?t(o.data.data):d(o.data.message)}).catch(()=>d("Ошибка загрузки дворов")).finally(()=>n(!1))},[]);const m=()=>{if(!a||!s.trim()){d("Заполните все поля!");return}p.post("/warehouse/addwarehouse",{name:s,yard_id:a}).then(o=>{o.data.status?(h(""),c(""),r(o.data.data)):d(o.data.message)}).catch(()=>d("Ошибка добавления склада"))};return e.jsxs(x,{sx:{maxWidth:400,margin:"auto",padding:3},children:[e.jsx("h2",{children:"Добавить новый склад"}),f&&e.jsx("p",{style:{color:"red"},children:f}),e.jsxs(R,{fullWidth:!0,sx:{mb:2},children:[e.jsx(A,{children:"Выберите двор"}),e.jsx(D,{value:a,onChange:o=>c(o.target.value),disabled:i,children:u.map(o=>e.jsx(k,{value:o.id,children:o.name},o.id))})]}),e.jsx(P,{label:"Название склада",fullWidth:!0,value:s,onChange:o=>h(o.target.value),sx:{mb:2}}),e.jsx(U,{variant:"contained",color:"primary",fullWidth:!0,onClick:m,children:"Добавить склад"})]})},X=()=>{const[r,u]=l.useState([]),[t,a]=l.useState(!0),c=K("(max-width: 768px)"),s=()=>{a(!0),p.post("/warehouse/getwarehouses").then(n=>{n.data.status&&u(n.data.data)}).catch(n=>console.error("Ошибка загрузки складов:",n)).finally(()=>a(!1))};l.useEffect(()=>{s()},[]);const h=()=>{s()},i=[{field:"id",headerName:"ID",width:c?50:80},{field:"name",headerName:"Название",flex:1,minWidth:150},{field:"address",headerName:"Адрес",flex:1,minWidth:200},{field:"phone",headerName:"Телефон",flex:1,minWidth:150},{field:"yard_name",headerName:"Зона",flex:2,minWidth:250}];return e.jsxs(x,{children:[e.jsx(V,{onWarehouseAdded:h}),e.jsxs(x,{sx:{width:"100%",maxWidth:"1200px",margin:"auto",padding:"10px"},children:[e.jsx("h2",{style:{textAlign:"center"},children:"Склады"}),t?e.jsx(x,{sx:{display:"flex",justifyContent:"center",padding:5},children:e.jsx(Y,{})}):e.jsx(x,{sx:{height:500,width:"100%"},children:e.jsx(_,{rows:r,columns:i,loading:t,getRowId:n=>n.id,pageSizeOptions:c?[5]:[5,10,20]})})]})]})},Z=[{title:"Склады",href:"/warehouses"}];function ie(){const[r,u]=l.useState([]),[t,a]=l.useState(!0);return e.jsxs(y,{breadcrumbs:Z,children:[e.jsx(v,{title:"Склады"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min p-4",children:e.jsx(X,{warehouses:r,loading:t})})})]})}export{ie as default};
