import{r as u,j as e,t as S,a as p,L as v}from"./app-CWw3lnKq.js";import{A as y}from"./app-layout-DmcVpiF6.js";import{s as W,a as N,u as C,e as E,b as L,g as I,c as M,d as B,C as T,T as j,f as Q,F,I as R,S as A,M as D,h as P,B as U,i as Y,D as _}from"./DataGrid-ZE9ONerK.js";import{b as k}from"./button-DbZ-m-Te.js";import"./index-BaSfRIGE.js";import"./index-CV8dIoGT.js";import"./shin-line-logo-DeoKgELm.js";function G(r={}){const{themeId:l,defaultTheme:t,defaultClassName:a="MuiBox-root",generateClassName:c}=r,s=W("div",{shouldForwardProp:i=>i!=="theme"&&i!=="sx"&&i!=="as"})(N);return u.forwardRef(function(n,f){const d=C(t),{className:m,component:o="div",...g}=E(n);return e.jsx(s,{as:o,ref:f,className:k(m,c?c(a):a),theme:l&&d[l]||d,...g})})}function O(r,l,t,a,c){const[s,h]=u.useState(()=>c&&t?t(r).matches:a?a(r).matches:l);return M(()=>{if(!t)return;const i=t(r),n=()=>{h(i.matches)};return n(),i.addEventListener("change",n),()=>{i.removeEventListener("change",n)}},[r,t]),s}const z={...S},b=z.useSyncExternalStore;function H(r,l,t,a,c){const s=u.useCallback(()=>l,[l]),h=u.useMemo(()=>{if(c&&t)return()=>t(r).matches;if(a!==null){const{matches:d}=a(r);return()=>d}return s},[s,r,a,c,t]),[i,n]=u.useMemo(()=>{if(t===null)return[s,()=>()=>{}];const d=t(r);return[()=>d.matches,m=>(d.addEventListener("change",m),()=>{d.removeEventListener("change",m)})]},[s,t,r]);return b(n,i,h)}function w(r={}){const{themeId:l}=r;return function(a,c={}){let s=L();s&&l&&(s=s[l]||s);const h=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:i=!1,matchMedia:n=h?window.matchMedia:null,ssrMatchMedia:f=null,noSsr:d=!1}=I({name:"MuiUseMediaQuery",props:c,theme:s});let m=typeof a=="function"?a(s):a;return m=m.replace(/^@media( ?)/m,""),(b!==void 0?H:O)(m,i,n,f,d)}}w();const $=B("MuiBox",["root"]),J=Q(),x=G({themeId:j,defaultTheme:J,defaultClassName:$.root,generateClassName:T.generate}),K=w({themeId:j}),V=({onWarehouseAdded:r})=>{const[l,t]=u.useState([]),[a,c]=u.useState(""),[s,h]=u.useState(""),[i,n]=u.useState(!0),[f,d]=u.useState("");u.useEffect(()=>{p.post("/yard/getyards").then(o=>{o.data.status?t(o.data.data):d(o.data.message)}).catch(()=>d("Ошибка загрузки дворов")).finally(()=>n(!1))},[]);const m=()=>{if(!a||!s.trim()){d("Заполните все поля!");return}p.post("/warehouse/addwarehouse",{name:s,yard_id:a}).then(o=>{o.data.status?(h(""),c(""),r(o.data.data)):d(o.data.message)}).catch(()=>d("Ошибка добавления склада"))};return e.jsxs(x,{sx:{maxWidth:400,margin:"auto",padding:3},children:[e.jsx("h2",{children:"Добавить новый склад"}),f&&e.jsx("p",{style:{color:"red"},children:f}),e.jsxs(F,{fullWidth:!0,sx:{mb:2},children:[e.jsx(R,{children:"Выберите двор"}),e.jsx(A,{value:a,onChange:o=>c(o.target.value),disabled:i,children:l.map(o=>e.jsx(D,{value:o.id,children:o.name},o.id))})]}),e.jsx(P,{label:"Название склада",fullWidth:!0,value:s,onChange:o=>h(o.target.value),sx:{mb:2}}),e.jsx(U,{variant:"contained",color:"primary",fullWidth:!0,onClick:m,children:"Добавить склад"})]})},X=()=>{const[r,l]=u.useState([]),[t,a]=u.useState(!0),c=K("(max-width: 768px)"),s=()=>{a(!0),p.post("/warehouse/getwarehouses").then(n=>{n.data.status&&l(n.data.data)}).catch(n=>console.error("Ошибка загрузки складов:",n)).finally(()=>a(!1))};u.useEffect(()=>{s()},[]);const h=()=>{s()},i=[{field:"id",headerName:"ID",width:c?50:80},{field:"name",headerName:"Название",flex:1,minWidth:150},{field:"address",headerName:"Адрес",flex:1,minWidth:200},{field:"phone",headerName:"Телефон",flex:1,minWidth:150},{field:"yard_name",headerName:"Зона",flex:2,minWidth:250}];return e.jsxs(x,{children:[e.jsx(V,{onWarehouseAdded:h}),e.jsxs(x,{sx:{width:"100%",maxWidth:"1200px",margin:"auto",padding:"10px"},children:[e.jsx("h2",{style:{textAlign:"center"},children:"Склады"}),t?e.jsx(x,{sx:{display:"flex",justifyContent:"center",padding:5},children:e.jsx(Y,{})}):e.jsx(x,{sx:{height:500,width:"100%"},children:e.jsx(_,{rows:r,columns:i,loading:t,getRowId:n=>n.id,pageSizeOptions:c?[5]:[5,10,20]})})]})]})},Z=[{title:"Склады",href:"/warehouses"}];function oe(){const[r,l]=u.useState([]),[t,a]=u.useState(!0);return e.jsxs(y,{breadcrumbs:Z,children:[e.jsx(v,{title:"Склады"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min p-4",children:e.jsx(X,{warehouses:r,loading:t})})})]})}export{oe as default};
